ğŸ” CDS AUTHORIZATION CHECK & DCL (Data Control Language)
(ğŸ“Œ CDS iÃ§inde kullanÄ±cÄ± bazlÄ± veri gÃ¼venliÄŸi)


ğŸ¯ Neden Bu Konuya Ä°htiyaÃ§ DuyarÄ±z?
CDS Viewâ€™ler veritabanÄ± Ã¼zerinde Ã§ok gÃ¼Ã§lÃ¼ sorgular Ã§alÄ±ÅŸtÄ±rÄ±r.
Ama ÅŸu sorular ortaya Ã§Ä±kar:
	â€¢ KullanÄ±cÄ± sadece kendi satÄ±ÅŸ belgelerini gÃ¶rebilsin istiyorum.
	â€¢ Veya bir mÃ¼dÃ¼r, yalnÄ±zca kendi departmanÄ±ndaki verileri gÃ¶rsÃ¼n.
	â€¢ SAP'de SE16N gibi ekranlardan geleneksel yetkiler Ã§alÄ±ÅŸÄ±r ama CDSâ€™te veri satÄ±rÄ± bazlÄ± filtre yapmak gerekir.
	Ä°ÅŸte burada Authorization Check ve DCL kullanÄ±lÄ±r.


ğŸ§  Temel MantÄ±k
	ABAP kodunda AUTHORITY-CHECK yapardÄ±k ya?
	CDS View iÃ§inde bu iÅŸi sistem kendisi yapar.
CDSâ€™te bunu:
	1. @AccessControl.authorizationCheck annotation'Ä± ile aktif hale getiririz
	2. DCL (Data Control Language) nesnesi ile kural tanÄ±mlarÄ±z


ğŸ§© Ã–rnek Ãœzerinden Gidelim

ğŸ”¹ 1. CDS View TanÄ±mÄ±

@AbapCatalog.sqlViewName: 'ZCDS_FLIGHT_AUTH'
@AccessControl.authorizationCheck: #CHECK
define view ZC_FLIGHT_AUTH as select from sflight
{
  carrid,
  connid,
  fldate
}

Bu CDS normalde herkese tÃ¼m veriyi getirir.
Ama authorizationCheck: #CHECK dediÄŸimiz iÃ§in sistem der ki:
	â€œVeriyi sadece kullanÄ±cÄ±ya yetkili olduÄŸu kadar getiririm.â€
	

ğŸ”¹ 2. DCL TanÄ±mÄ± (ZC_FLIGHT_AUTH DCL)

SECDS ekranÄ±na gir â†’ "New" â†’ DCL nesnesi oluÅŸtur.

define role ZFLIGHT_ROLE {
  grant select on ZC_FLIGHT_AUTH
    where carrid = aspect pfcg_auth(CARRID);
}


AÃ§Ä±klama:
	â€¢ Bu DCL diyor ki:
â€œZC_FLIGHT_AUTH viewâ€™indeki satÄ±rlar sadece, CARRID alanÄ± iÃ§in PFCG yetkisine sahip olunan deÄŸerlerle eÅŸleÅŸiyorsa gelir.â€
	â€¢ Yani SAP rolÃ¼nde tanÄ±mlÄ± olan yetkilere gÃ¶re (Ã¶rneÄŸin: S_CARRID = 'LH') sadece o deÄŸer gÃ¶sterilir.


ğŸ“¦ SonuÃ§: Ne Oldu?
	1. CDS Viewâ€™in iÃ§inde authorizationCheck aktifleÅŸtirildi.
	2. DCL ile filtre kuralÄ± tanÄ±mlandÄ±.
	3. ArtÄ±k bu CDSâ€™yi kim kullanÄ±rsa kullansÄ±n, veriler sadece yetkili olduklarÄ± kadar gelir.

âœ… AvantajlarÄ±
Ã–zellik	AÃ§Ä±klama
CDS seviyesinde gÃ¼venlik	Kod yazmadan veri eriÅŸimi kontrolÃ¼
UI ve raporlara otomatik uygulanÄ±r	RAP, Fiori, OData hepsi uyumlu
SatÄ±r bazlÄ± yetkilendirme	KullanÄ±cÄ± sadece izinli olduÄŸu veriyi gÃ¶rÃ¼r


âš ï¸ Dikkat Edilmesi Gerekenler
UyarÄ±	AÃ§Ä±klama
DCL devreye girince veriler filtrelenir	Kodda neden veri eksik geliyor gibi hissedebilirsin :)
#NOT_REQUIRED yazarsan kontrol yapÄ±lmaz	Genelde test CDS'lerinde kullanÄ±lÄ±r
aspect pfcg_auth sadece yetkilendirme nesnesiyle Ã§alÄ±ÅŸÄ±r	PFCG rolÃ¼yle eÅŸleÅŸtirme gerekir



